<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     The Plain Text is a Lie | 
    Engineering Health
  
</title><meta name="description" content="a blog by engineers, for engineers"><meta name="author" content="Elliott Hoffman">

<link rel="icon" href="/favicon.png">


    
        
            <link rel="stylesheet" href="/dist/main.2b1315bd4c5d4f5eb804.min.css">
        
    




<link rel="canonical" href="https://engineering.cerner.com/blog/the-plain-text-is-a-lie/"><script src="/js/jquery-3.5.1.min.js"></script><meta property="og:title" content="The Plain Text is a Lie" />
<meta property="og:description" content="There is no such thing as plain text &ldquo;But I see .txt files all the time&rdquo; you say. &ldquo;My source code is plain text&rdquo; you claim. &ldquo;What about web pages?!&rdquo; you frantically ask. True, each of those things is comprised of text. The plain part is the problem. Plain denotes default or normal. There is no such thing. Computers store and transmit data in a number of methods; each are anything but plain." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://engineering.cerner.com/blog/the-plain-text-is-a-lie/" /><meta property="og:image" content="https://engineering.cerner.com/images/alan-grace.png"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2014-08-02T00:00:00+00:00" />
<meta property="article:modified_time" content="2014-08-02T00:00:00+00:00" /><meta property="og:site_name" content="Cerner Engineering" />

<meta itemprop="name" content="The Plain Text is a Lie">
<meta itemprop="description" content="There is no such thing as plain text &ldquo;But I see .txt files all the time&rdquo; you say. &ldquo;My source code is plain text&rdquo; you claim. &ldquo;What about web pages?!&rdquo; you frantically ask. True, each of those things is comprised of text. The plain part is the problem. Plain denotes default or normal. There is no such thing. Computers store and transmit data in a number of methods; each are anything but plain."><meta itemprop="datePublished" content="2014-08-02T00:00:00+00:00" />
<meta itemprop="dateModified" content="2014-08-02T00:00:00+00:00" />
<meta itemprop="wordCount" content="3036"><meta itemprop="image" content="https://engineering.cerner.com/images/alan-grace.png"/>
<meta itemprop="keywords" content="design,engineering,i18n,Unicode,text," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://engineering.cerner.com/images/alan-grace.png"/>

<meta name="twitter:title" content="The Plain Text is a Lie"/>
<meta name="twitter:description" content="There is no such thing as plain text &ldquo;But I see .txt files all the time&rdquo; you say. &ldquo;My source code is plain text&rdquo; you claim. &ldquo;What about web pages?!&rdquo; you frantically ask. True, each of those things is comprised of text. The plain part is the problem. Plain denotes default or normal. There is no such thing. Computers store and transmit data in a number of methods; each are anything but plain."/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand" href="/"><img src="/logo.png" style='width: 100px;' /></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div id="main-menu" class="collapse navbar-collapse" >
            <ul class="nav navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/culture/">Culture</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/open-source/">Open Source</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/tech-talks/">Tech Talks</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/careers/">Careers</a></li>
                
            
            </ul>
            
            <div class="form-inline my-2 my-lg-0 searchbox">
    <input id="search-by" type="search" class="form-control mr-sm-2" placeholder="Search" aria-label="Search">
</div>

<script type="text/javascript" src="/js/lunr.min.js"></script>
<script type="text/javascript" src="/js/auto-complete.min.js"></script>
<script type="text/javascript">
    var baseurl =  "https:\/\/engineering.cerner.com";
</script>
<script type="text/javascript" src="/js/search.js"></script>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article class="article-content">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">August 2, 2014</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>3036 words</span>
                            <span><i class="fas fa-clock mr-2"></i>15 mins read</span>
                        </div>

                        <h1>The Plain Text is a Lie</h1>

                        <ul class="authors list-inline">
        By: &nbsp;<li class="list-inline-item mr-3">
                    <div class="media author">
                            👤&nbsp;<div class="media-body">
                            <h5 class="name my-0 "><a href="/authors/elliott-hoffman/" class="small">Elliott Hoffman</a>
                            </h5>
                        </div>
                    </div>
                </li></ul>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <h2 id="there-is-no-such-thing-as-plain-text">There is no such thing as plain text</h2>
<p>&ldquo;But I see .txt files all the time&rdquo; you say. &ldquo;My source code is plain text&rdquo; you claim. &ldquo;What about web pages?!&rdquo; you frantically ask. True, each of those things is comprised of text. The <em>plain</em> part is the problem. Plain denotes default or normal. There is no such thing. Computers store and transmit data in a number of methods; each are anything but <em>plain</em>. If you write software, design websites or test systems where even a single character of text is accepted as input, displayed as output, transmitted to another system or stored for later - please read on to learn why the plain text is a lie!</p>
<p>The topic of text handling applies to many disciplines:</p>
<ul>
<li><strong>UX/web designers</strong> - Your UX is the last mile of displaying text to users.</li>
<li><strong>API developers</strong> - Your APIs should tell your consumers what languages, encodings and character sets your service supports.</li>
<li><strong>DBAs</strong> - You should know what kinds of text your database can handle.</li>
<li><strong>App developers</strong> - You apps should not crash when non-English characters are encountered.</li>
</ul>
<p>After reading this article you will …</p>
<!-- raw HTML omitted -->
<p>This topic has been extensively written about already. I highly recommend reading Joel Spolsky&rsquo;s <a href="http://www.joelonsoftware.com/articles/Unicode.html">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a>. You should also read up on how your system handles strings. Then, go read how the APIs you talk to send/receive strings. Pythonistas, check out Ned Batchelder&rsquo;s <a href="http://nedbatchelder.com/text/unipain.html">Pragmatic Unicode</a> presentation.</p>
<p>OK, let&rsquo;s get started!</p>
<h2 id="thumbnail-resumejpeg">Part I - Gallery of FAIL or &ldquo;When text goes wrong, by audience&rdquo;
thumbnail: &ldquo;resume.jpeg&rdquo;</h2>
<p>Let&rsquo;s start off by demonstrating how text handling can fail, and fail hard. The following screen shots and snippets show some of the ways text handling can fail and who should care about the type of failure.</p>
<h3 id="ux-and-web-people">UX and web people</h3>
<div align="center">
    <figure class="figure">
        <a href="resume.jpeg" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="resume.jpeg"
                alt="Resumé Wikipedia article rendered in the wrong encoding"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<p>The above image shows the English wikipedia article on <!-- raw HTML omitted -->Résumés<!-- raw HTML omitted --> with garbled text. Garbled text can happen if your web pages don&rsquo;t specify an encoding or character set in your markup. Specifying the <em>wrong</em> encoding can also cause garbled text. XML and JavaScript need correct character sets too. It&rsquo;s important to note that <!-- raw HTML omitted -->no error or exception was raised here<!-- raw HTML omitted -->. The text looks wrong to the user, but the failure happens silently.</p>
<div align="center">
    <figure class="figure">
        <a href="tokyo.jpeg" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="tokyo.jpeg"
                alt="Tokyo Wikipedia article Aramaic translation"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<p>This <a href="http://arc.wikipedia.org/wiki/%DC%9B%DC%98%DC%A9%DC%9D%DC%98">article on Tokyo</a> above is displayed in a language (Aramaic) that my fonts don&rsquo;t support. Instead of a symbol, we see a box with a number identifying the un-showable character. If you think that example is too contrived, here is a more commonly used symbol: a <a href="http://www.fileformat.info/info/unicode/char/1d161/browsertest.htm">16th note from sheet music</a>. Many perfectly valid characters are not supported by widely used fonts. Specialized web fonts might not support the characters you need.</p>
<div align="center">
    <figure class="figure">
        <a href="music.jpeg" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="music.jpeg"
                alt="Music note character test page"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<h3 id="api-developers">API developers</h3>
<pre tabindex="0"><code>//Fetch the Universal Declaration of Human Rights in Arabic
documentAPIClient.getTitle(docID=123)
</code></pre><div align="center">
    <figure class="figure">
        <a href="mojibake1.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="mojibake1.png"
                alt="Mojibake example 1"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<p>The result of this API call (<!-- raw HTML omitted -->example source<!-- raw HTML omitted -->) is similar to the last two examples: nonsense text. This can happen if the client and server use different text encodings. By the way, this situation happens so often that there&rsquo;s a term for it: <a href="https://en.wikipedia.org/wiki/Mojibake">Mojibake</a>.</p>
<p>Here are some client/server scenarios resulting in Mojibake:</p>
<ul>
<li>The server didn&rsquo;t document their encoding and the client guessed the wrong encoding.</li>
<li>The server or client inherit the encoding of their execution environment (virtual machine, OS, parent process, etc.), but the execution environment&rsquo;s settings changed from their original values.</li>
</ul>
<h3 id="dbas">DBAs</h3>
<div align="center">
    <figure class="figure">
        <a href="mojibake2.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="mojibake2.png"
                alt="Mojibake example 2"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<p>Database systems can be misconfigured such that characters sent to the database are not stored accurately. In this example, the offending characters are replaced with the imaginatively-named <em>Replacement Character</em> (&ldquo;�&rdquo;). The original characters are forever lost. Worse still, replacement characters will be returned by your queries and ultimately shown to your users. Sometimes, offending characters will be omitted from the stored value or replaced with a nearest match supported character. In both scenarios the database has mangled the original data.</p>
<h3 id="app-developers">App developers</h3>
<div align="center">
    <figure class="figure">
        <a href="stack-trace.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="stack-trace.png"
                alt="Unicode encoding error traceback"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scala" data-lang="scala"><span style="display:flex;"><span>org<span style="color:#f92672">.</span>scalatest<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span><span style="color:#a6e22e">TestFailedException</span><span style="color:#66d9ef">:</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">d</span><span style="color:#f92672">[</span><span style="color:#66d9ef">Ã</span><span style="color:#960050;background-color:#1e0010">©</span><span style="color:#f92672">]</span>funt<span style="color:#e6db74">&#34; did not equal &#34;</span>d<span style="color:#f92672">[</span><span style="color:#66d9ef">é</span><span style="color:#f92672">]</span>funt<span style="color:#960050;background-color:#1e0010">&#34;</span>
</span></span><span style="display:flex;"><span>at org<span style="color:#f92672">.</span>scalatest<span style="color:#f92672">.</span><span style="color:#a6e22e">MatchersHelper</span>$<span style="color:#f92672">.</span>newTestFailedException<span style="color:#f92672">(</span><span style="color:#a6e22e">MatchersHelper</span><span style="color:#f92672">.</span>scala<span style="color:#66d9ef">:</span><span style="color:#960050;background-color:#1e0010">160</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>at sun<span style="color:#f92672">.</span>reflect<span style="color:#f92672">.</span><span style="color:#a6e22e">NativeMethodAccessorImpl</span><span style="color:#f92672">.</span>invoke<span style="color:#f92672">(</span><span style="color:#a6e22e">NativeMethodAccessorImpl</span><span style="color:#f92672">.</span>java<span style="color:#66d9ef">:</span><span style="color:#960050;background-color:#1e0010">39</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>at com<span style="color:#f92672">.</span>intellij<span style="color:#f92672">.</span>rt<span style="color:#f92672">.</span>execution<span style="color:#f92672">.</span>application<span style="color:#f92672">.</span><span style="color:#a6e22e">AppMain</span><span style="color:#f92672">.</span>main<span style="color:#f92672">(</span><span style="color:#a6e22e">AppMain</span><span style="color:#f92672">.</span>java<span style="color:#66d9ef">:</span><span style="color:#960050;background-color:#1e0010">134</span><span style="color:#f92672">)</span>
</span></span></code></pre></div><p>The top image shows the 500 page of an app that crashed when improperly encoding. In the Scala error message (bottom), a property file was read in <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1">ISO-8859-1</a> encoding but had UTF-8 encoded bytes in it. This caused the unit test to fail.</p>
<p>Your source code, web pages, properties files, and any other text artifact you work with has an encoding. Every tool in your development tool chain (local server, terminal, editor, browser, CI system, etc.) is a potential failure point if these encodings are not honoroed.</p>
<h2 id="part-ii---avoid-text-handling-problems">Part II - Avoid text handling problems</h2>
<h3 id="ghost-in-the-machine">Ghost in the machine</h3>
<p>You&rsquo;ve seen examples of failure and (hopefully) are wondering how such failures can be avoided. To avoid failure you must ask yourself one question: &ldquo;Can my system store and transmit a ghost?&rdquo;</p>
<div align="center">
    <figure class="figure">
        <a href="ghost.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="ghost.png"
                alt="GHOST unicode character"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<p><em>GHOST</em> (code point <a href="http://codepoints.net/U+1F47B">U+1F47B</a>) is a valid (albeit weird) part of the <a href="http://www.unicode.org/standard/WhatIsUnicode.html">Unicode</a> standard. Unicode is a system of storing and manipulating text that supports thousands of languages.  Using Unicode properly will go a long way to prevent text handling problems. Thus, if your system can store, transmit, read and write GHOST then you&rsquo;re doing it right. But how to handle this GHOST?</p>
<h3 id="some-terminology">Some Terminology</h3>
<p>You need to know some terms before the rest of this article will make any sense.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Remembering the difference between <em>encode</em> and <em>decode</em> can be difficult. One trick to keep them straight is to think of Unicode objects as the ideal state of being (thanks, <a href="http://www.joelonsoftware.com/articles/Unicode.html">Joel Spolksy</a>) and byte-strings as strange, cryptic sequences. Encoding turns the ideal into a bunch of cryptic bytes, while decoding un-weirds a bunch of bytes back into the ideal state; something we can reason about. Some systems use different terms but the ideas still apply. For example: Java Strings are Unicode objects and you can encode/decode to/from byte-strings with them.</p>
<p>Now that you&rsquo;ve got the necessary terminology under your belt, let&rsquo;s prevent text handling problems in our system by making a sandwich; a Unicode sandwich!</p>
<h2 id="make-a-unicode-sandwich">Make a Unicode sandwich</h2>
<p><em>Analogy credit</em>: <a href="http://nedbatchelder.com/">Ned Batchelder</a> coined the Unicode sandwich analogy in his <a href="http://nedbatchelder.com/text/unipain.html">Pragmatic Unicode</a> presentation at PyCon 2012 (<a href="http://youtu.be/sgHbC6udIqc">video</a>). It&rsquo;s so clever that I can&rsquo;t resist re-using it in this article!</p>
<p><div align="center">
    <figure class="figure">
        <a href="unicode-sandwich.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="unicode-sandwich.png"
                alt="The unicode sandwich"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<!-- raw HTML omitted -->Original image<!-- raw HTML omitted --></p>
<p>In this analogy the pieces of bread on the top and bottom are regions of your code where you deal with byte-strings. The meat in the middle is where your system deals in Unicode objects. The top bread is input into your system such as database query results, file reads or HTTP responses. The bottom bread is output from your system such as writing files or sending HTTP responses. The meat is your business logic.</p>
<h3 id="good-sandwiches-are-meaty">Good sandwiches are meaty</h3>
<p>Your goal is to keep the bread thin and the meat thick. You can achieve this by decoding from byte-strings to Unicode objects as early as you can; perhaps immediately after arrival from another system. Similarly, you should do your encoding from Unicode objects into byte-strings at the last possible moment, such as right before transmitting text to another system.</p>
<p>Working with Unicode inside your system gives you a common ground of text handling that will largely avoid the errors we&rsquo;ve seen at the top of this article. If you don&rsquo;t deal in Unicode inside your system then you are limiting the languages you support at best and exposing yourself to text handling bugs at worst!</p>
<h3 id="the-best-sandwich-bread-is-utf-8">The best sandwich bread is UTF-8</h3>
<p>Your system ultimately needs to send and receive byte-strings at some point, so you must choose an encoding for your byte-strings. Encodings are not created equal! Some encodings only support one language. Some support only similar languages (for example, German and French but not Arabic). Never assume your system will only encounter languages you speak or write! Ideally you will choose encodings that support a great many languages.</p>
<p>UTF-8 is the best general purpose encoding for your byte-strings. You&rsquo;ll learn why UTF-8 is an excellent encoding choice later in this article in the <em>Unicode: One standard to rule them all</em> section. For now I recommend you:</p>
<ul>
<li>Choose UTF-8 for all byte-strings.</li>
<li>Configure your system to use this encoding explicitly. Do not rely on the parent system (OS, VM, etc.) to provide an encoding since system settings might change over time.</li>
<li>Document your encoding choice in both public facing and internal documentation.</li>
</ul>
<p>The UTF-8 encoding supports all the text you&rsquo;d ever want. Yet, in this imperfect world you might be forced to use a more limited encoding such as ISO-8859-1 or Windows-1252 when interfacing with other systems. Working with a limited encoding presents problems when decoding to and encoding from Unicode: not every encoding supports the full Unicode range of characters. You must test how your system converts between your byte-strings and Unicode objects. In other words, <em>test between the meat and the bread</em>.</p>
<h3 id="testing-between-the-meat-and-the-bread">Testing between the meat and the bread</h3>
<p>The critical areas to test are where bytes strings are decoded to Unicode objects and where Unicode objects are encoded into byte-strings. If you&rsquo;ve followed the advice of this article thus far then the rest of your app logic should operate exclusively in Unicode objects. Here is a handy table of how to test regions of your system that encode and decode:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 id="unicode-sandwich-applies-to-new-projects-and-legacy-systems">Unicode sandwich applies to new projects and legacy systems</h3>
<p>Using UTF-8 for I/O, Unicode inside and testing the in-between points will save you from pain and bugs. If you&rsquo;re building a new system then you have the opportunity to design it with Unicode in mind. If you have an existing system, it is worth your time to audit how your system handles text.</p>
<p>With the practical stuff out of the way, let&rsquo;s dive deeper into computers and text!</p>
<h2 id="part-iii---encodings-unicode-and-how-computers-handle-text">Part III - Encodings, Unicode and how computers handle text</h2>
<p>We&rsquo;ve talked about how you should use Unicode, encodings and byte-strings in your system to handle text. You may be wondering why text handling is so painful at times. Why are there so many encodings and why don&rsquo;t they all work together in harmony? I&rsquo;ll attempt to explain a bit of history behind text handling in computers. Understanding this history should shed some light on why text handling can be so painful.</p>
<p>To make things interesting, let&rsquo;s pretend we are inventing how computers will handle text. Also assume we live in the United States and speak only English. That&rsquo;s a pretty ignorant assumption for real world software development, but it simplifies our process.</p>
<h3 id="ascii-works-great-if-you-want-to-ignore-most-of-the-world">ASCII: Works great (if you want to ignore most of the world)</h3>
<p>Our challenge is to invent how computers handle text. Morse code is an encoding that pre-dates digital computers but provides a model for our approach: Each character has a transmission sequence of dots and dashes to represent it. We&rsquo;ll need to make a few changes and additions though&hellip;</p>
<p><div align="center">
    <figure class="figure">
        <a href="morse-code.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="morse-code.png"
                alt="Morse code"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<!-- raw HTML omitted -->Image source<!-- raw HTML omitted --></p>
<p>Rather than dots and dashes we can use 1&rsquo;s and 0&rsquo;s (<a href="http://en.wikipedia.org/wiki/Binary_number">binary</a>). Let&rsquo;s also use a consistent number of bits per character so that it&rsquo;s easy to know when one character ends and another begins. To support US English we need to map a binary sequence to each of the following:</p>
<ul>
<li>a-z</li>
<li>A-Z</li>
<li>0-9</li>
<li>&quot; &ldquo;(space)</li>
<li>!&rdquo;#$%&amp;&rsquo;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~</li>
<li>Control characters like &ldquo;ring a bell&rdquo;, &ldquo;make a new line&rdquo;, etc.</li>
</ul>
<p>That&rsquo;s 96 printable characters and some control characters for a total of 128 characters. 128 is 2<!-- raw HTML omitted -->7<!-- raw HTML omitted -->, so we can send these characters in seven-bit sequences. Since computers use eight-bit bytes, let&rsquo;s decide to send eight bits per character but ignore the last bit. We have just invented the <a href="https://en.wikipedia.org/wiki/ASCII">ASCII encoding</a>!</p>
<p>ASCII forms the root influence of many text encodings still used today. In fact, at one time ASCII was the law: U.S. President Lyndon B. Johnson <!-- raw HTML omitted -->mandated<!-- raw HTML omitted --> that all computers purchased by the United States federal government support ASCII in 1968.</p>
<p><div align="center">
    <figure class="figure">
        <a href="johnson.jpg" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="johnson.jpg"
                alt="President Lyndon Johnson"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<!-- raw HTML omitted -->Image source<!-- raw HTML omitted --></p>
<h3 id="international-and-oem-standards-supporting-other-languages">International and OEM standards: Supporting other languages</h3>
<h4 id="starting-with-similar-languages-to-us-english">Starting with similar languages to US English</h4>
<p>We need more space to pack in more symbols if we want to support other languages and other symbols like currencies. It seems reasonable that people typically deal with a block of languages that are geographically or politically related, and when we&rsquo;re lucky those languages share many of the same symbols. Given that assumption we can create several standards; each one for a block of languages!</p>
<p>For each block, we can keep the first 128 characters as-is from ASCII (identical bit sequences) so that the US English characters and Arabic numerals are still supported. We can then use the eighth bit for data instead of ignoring it. That would give us eight bits per character and a total of 256 characters to work with (double ASCII&rsquo;s paltry 128). Now let&rsquo;s apply that eight bit.</p>
<p>A bunch of countries in Western Europe use the same latin alphabet plus special <a href="http://en.wikipedia.org/wiki/Diacritic">diacritics</a> (also known as <!-- raw HTML omitted -->accent marks<!-- raw HTML omitted -->) like ü or é or ß. In fact, we can pack enough extra characters in those last 128 slots to support 29 other languages like Afrikaans, German, Swahili and Icelandic. Our Western European language block encoding is ready! We call this type of encoding a single-byte encoding because every character is represented by exactly one byte.</p>
<p><div align="center">
    <figure class="figure">
        <a href="1252.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="1252.png"
                alt="Windows 1252 code page"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<!-- raw HTML omitted -->Image source<!-- raw HTML omitted --></p>
<h4 id="additional-single-byte-encodings-for-other-language-blocks">Additional single byte encodings for other language blocks</h4>
<p>We can repeat the same process we used to create our Western European language encoding to develop other single-byte encodings for other language blocks; each a 256 character set! To give one more example, let&rsquo;s build a single byte coding for Arabic.</p>
<p>Again, we take the first 128 ASCII characters as-is, then fill up the last 128 with the <a href="http://www.omniglot.com/writing/arabic.htm">Arabic alphabet</a>  We&rsquo;ve got some space left over. Arabic has some diacritics as well, so let&rsquo;s use some of the leftover slots to hold diacritic marks that are only valid when combined with other letters.</p>
<p>Some languages don&rsquo;t even fit in 256 characters. Chinese, Japanese and Korean for example. That&rsquo;s OK, we&rsquo;ll just use multiple bytes per character to get more room. As you may have guessed, these encodings are called <!-- raw HTML omitted -->multibyte encodings<!-- raw HTML omitted -->. Sometimes we choose to use the same number of bytes for every character (<!-- raw HTML omitted -->fixed width<!-- raw HTML omitted --> multibyte encodings) and sometimes we might choose to use different byte lengths (<!-- raw HTML omitted -->variable width<!-- raw HTML omitted --> multibyte encodings) to save space.</p>
<h3 id="ratifying-our-encodings-to-standards">Ratifying our encodings to standards</h3>
<p>After we&rsquo;ve built several of these encodings (Russian, Greek, Simplified Chinese, etc.) we can ratify them as international standards such as <a href="https://en.wikipedia.org/wiki/ISO_8859">ISO-8859</a> for single byte encodings. We previously built <a href="http://en.wikipedia.org/wiki/ISO/IEC_8859-1">ISO-8895-1 (Western European)</a> and <a href="http://en.wikipedia.org/wiki/ISO/IEC_8859-6">ISO-8859-6 (Latin/Arabic)</a>. International standards for multibyte encodings exist too. People who use the same standard can communicate without problems.</p>
<p>The international standards like ISO-8895 are only part of the story. Companies like Microsoft and IBM created their own standards (so-called <!-- raw HTML omitted -->OEM standards<!-- raw HTML omitted --> or <!-- raw HTML omitted -->code pages<!-- raw HTML omitted -->). Some OEM standards map to international standards, some almost-but-not-quite map (see <a href="http://en.wikipedia.org/wiki/Windows-1252">Windows-1252</a>) and some are completely different.</p>
<h3 id="our-standards-have-problems">Our standards have problems</h3>
<p>Our standards and code pages are better than ASCII but there are a number of problems remaining:</p>
<ul>
<li>How do we intermix different languages in the same document?</li>
<li>What if our standards run out of room for new symbols?</li>
<li>There is no rosetta stone to allow communication between systems that use different encodings.</li>
</ul>
<p>Enter Unicode.</p>
<h2 id="unicode-one-standard-to-rule-them-all">Unicode: One standard to rule them all</h2>
<p><div align="center">
    <figure class="figure">
        <a href="ring.png" class="d-block" data-toggle="lightbox" data-gallery="post-gallery">
            <img src="ring.png"
                alt="The ring of power"class="figure-img img-fluid"
            /> 
        </a>
    </figure>
</div>
<!-- raw HTML omitted -->Image source<!-- raw HTML omitted --></p>
<p>As mentioned earlier, Unicode is a single standard supporting thousands of languages. Unicode addresses the limitations of byte encodings by operating at a higher level than simple byte representations of characters. The foundation of Unicode is an über list of symbols chosen by a multinational committee.</p>
<p>Unicode keeps a gigantic numbered list of all the symbols of all the supported languages. The items in this list are called <!-- raw HTML omitted -->code points<!-- raw HTML omitted --> and are not concerned with bytes, how computers represent them, or what they look like on screen. They&rsquo;re just numbered items, like:</p>
<p><!-- raw HTML omitted -->a<!-- raw HTML omitted --> <em>LATIN SMALL LETTER A</em> - U+0061</p>
<p><!-- raw HTML omitted -->東<!-- raw HTML omitted --> <em>Pinyin: dōng, Chaizi: shi,ba,ri</em> -  U+6771</p>
<p><!-- raw HTML omitted -->☃<!-- raw HTML omitted --> <a href="http://unicodesnowmanforyou.com/">SNOWMAN</a> - U+2603</p>
<p>We have virtually unlimited space to work with. The Unicode standards supports a maximum of  1,114,112 items. That is more than enough to express the world&rsquo;s active written languages, some historical languages and miscellaneous symbols. Some of the slots are even undefined and left to the user to decide what they mean. These spaces have been used for wacky things like <a href="https://en.wikipedia.org/wiki/Klingon_alphabets#ConScript_Unicode_Registry">Klingon</a> and Elvish.</p>
<p>Fun fact: Apple Inc. <!-- raw HTML omitted -->uses<!-- raw HTML omitted --> U+F8FF in the Private Use Area of Unicode for their logo symbol (<!-- raw HTML omitted --><!-- raw HTML omitted -->). If you don&rsquo;t see the Apple logo in parenthesis in the preceding sentence, then your system doesn&rsquo;t agree with Apple&rsquo;s use of U+F8FF.</p>
<p>OK, we have our gigantic list of code points. All we need to do is devise an encoding scheme to encode unicode objects (which now we know are lists of code points) into byte-strings for transmission over the wire to other systems.</p>
<h3 id="utf-8">UTF-8</h3>
<p>UTF-8 encodes every Unicode code point in between one and four byte sequences. Here are some cool features of UTF-8:</p>
<ul>
<li><em>Popularity</em> - It&rsquo;s the dominant encoding of the world wide web <a href="http://googleblog.blogspot.com/2010/01/unicode-nearing-50-of-web.html">since 2010</a>.</li>
<li><em>Simplicity</em> - No need to <a href="http://en.wikipedia.org/wiki/Byte_order_mark">transmit byte order information</a> or worry about <a href="http://en.wikipedia.org/wiki/Endianness">endianness</a> in transmissions.</li>
<li><em>Backwards compatibility</em> - The first 128 byte sequences are identical to ASCII.</li>
</ul>
<h3 id="ucs-2-old-and-busted">UCS-2: Old and busted</h3>
<p>UCS-2 is a fixed width, two-byte encoding. In the mid-nineties, Unicode added code points that cannot be expressed in the two-byte system. Thus, UCS-2 is deprecated in favor of UTF-16.</p>
<ul>
<li>UCS-2 was the original Java String class&rsquo;s internal representation</li>
<li>C Python 2 and 3 use UCS-2 if compiled with default options</li>
<li>Microsoft Windows OS API used UCS-2 prior to Windows 2000</li>
</ul>
<h3 id="utf-16-ucs-2">UTF-16: UCS-2++</h3>
<p>UTF-16 extends UCS-2 by adding support for the code points that can&rsquo;t be expressed in a two-byte system. You can find UTF-16 in:</p>
<ul>
<li>Windows 2000 and later&rsquo;s OS API</li>
<li>The Java String class</li>
<li>.NET environment</li>
<li>OS X and iOS&rsquo;s NSString type</li>
</ul>
<h3 id="utf-32-large-bytes-simple-representation">UTF-32: Large bytes, simple representation</h3>
<p>UTF-32 is a simple 1:1 mapping of code points to four-byte values. C Python uses UTF-32 for internal representation of Unicode if compiled with a certain flag.</p>
<h2 id="conclusion">Conclusion</h2>
<p>We&rsquo;ve seen how text handling can go wrong. We&rsquo;ve learned how to design and test our systems with Unicode in mind. Finally, we&rsquo;ve learned a bit of history of text encodings. There is a lot more to the topic of text, but for now I ask you do to the following:</p>
<ol>
<li>Examine your system to see if you&rsquo;re using Unicode inside</li>
<li>Use UTF-8 when reading and writing data</li>
<li>Know that the plain text is a lie!</li>
</ol>
<p>Thanks for reading!</p>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/design">
                                    <i class="fas fa-tag mr-2"></i>design
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/engineering">
                                    <i class="fas fa-tag mr-2"></i>engineering
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/i18n">
                                    <i class="fas fa-tag mr-2"></i>i18n
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/unicode">
                                    <i class="fas fa-tag mr-2"></i>Unicode
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/text">
                                    <i class="fas fa-tag mr-2"></i>text
                                </a></div><ul class="share nav my-3 justify-content-end">
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fengineering.cerner.com%2fblog%2fthe-plain-text-is-a-lie%2f&text=The%20Plain%20Text%20is%20a%20Lie">
              <i class="fa-fw fab fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fengineering.cerner.com%2fblog%2fthe-plain-text-is-a-lie%2f&title=The%20Plain%20Text%20is%20a%20Lie">
                <i class="fa-fw fab fa-linkedin-in"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fengineering.cerner.com%2fblog%2fthe-plain-text-is-a-lie%2f&t=The%20Plain%20Text%20is%20a%20Lie">
                <i class="fa-fw fab fa-facebook-f"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" target="_blank" href="https://reddit.com/submit?url=https%3a%2f%2fengineering.cerner.com%2fblog%2fthe-plain-text-is-a-lie%2f&title=The%20Plain%20Text%20is%20a%20Lie">
                <i class="fa-fw fab fa-reddit-alien"></i>
            </a>
        </li>
    </nav>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div></article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/blog/scaling-people-with-apache-crunch/" class="d-block"><img data-src="/blog/scaling-people-with-apache-crunch/team_bigdata_hudf78c4a0c0e481b6ad1e80af8ac1770d_181162_700x350_fill_box_smart1_3.png" class="card-img-top mx-auto d-block" alt="Scaling People with Apache Crunch"><div class="card-body">
            <h4 class="card-title">Scaling People with Apache Crunch</h4>
            <p class="card-text text-muted text-uppercase">May 9, 2014</p>
            <div class="card-text">
                Starting the Big Data Journey When a company first starts to play with Big Data it typically involves a small team of engineers trying to solve a specific problem. The team decides to experiment with scalable technologies either due to outside guidance or research which makes it applicable to their problem. The team begins with the basics of Big Data spending time learning and prototyping. They learn about HDFS, flirt with HBase or other NoSQL, write the required WordCount example, and start to figure out how the technologies can fit their needs.
            </div>
        </div>
    </a>
  </div>
            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/blog/thinking-in-mapreduce/" class="d-block"><img data-src="/blog/thinking-in-mapreduce/MapReduce1_hu436bc019973155fe9855a21e1b676571_45310_700x350_fill_box_smart1_3.png" class="card-img-top mx-auto d-block" alt="Thinking in MapReduce"><div class="card-body">
            <h4 class="card-title">Thinking in MapReduce</h4>
            <p class="card-text text-muted text-uppercase">July 31, 2013</p>
            <div class="card-text">
                This is the blog form of the Thinking in MapReduce talk at StampedeCon 2013. I’ve linked to existing resources for some items discussed in the talk, but the structure and major points are here.
We programmers have had it pretty good over the years. In almost all cases, hardware scaled up faster than data size and complexity. Unfortunately, this is changing for many of us. Moore’s Law has taken on a new direction; we gain power with parallel processing rather than faster clock cycles.
            </div>
        </div>
    </a>
  </div>
            </div><div class="col mb-3">
                <div class="card h-100">
    
    <a href="/blog/near-real-time-processing-over-hadoop-and-hbase/" class="d-block"><img data-src="/blog/near-real-time-processing-over-hadoop-and-hbase/chart-search-screen_hu26ee20457c5aa986f1cc23f95c01380d_648930_700x350_fill_box_smart1_3.png" class="card-img-top mx-auto d-block" alt="Near Real-time Processing Over Hadoop and HBase"><div class="card-body">
            <h4 class="card-title">Near Real-time Processing Over Hadoop and HBase</h4>
            <p class="card-text text-muted text-uppercase">February 27, 2013</p>
            <div class="card-text">
                From MapReduce to realtime This post covers much of the Near-Realtime Processing Over HBase talk I’m giving at ApacheCon NA 2013 in blog form. It also draws from the Hadoop, HBase, and Healthcare talk from StrataConf/Hadoop World 2012.
The first significant use of Hadoop at Cerner came in building search indexes for patient charts. While creation of simple search indexes is almost commoditized, we wanted a better experience based on clinical semantics.
            </div>
        </div>
    </a>
  </div>
            </div></div>
</main>


    <footer class="footer text-center bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://engineering.cerner.com/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                            <a href="https://github.com/cerner" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://www.instagram.com/cernercorporation/" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-instagram fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/cerner-corporation" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fengineering.cerner.com%2F&amp;screen_name=CernerEng" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://www.youtube.com/user/cernereng?sub_confirmation=1" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-light">
                    
                        Copyright &copy; 2022
                    
                </p>

                <p class="text-light">
                Made with ❤️ by Cerner engineers.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/main.0f92af9103b4f0550a4b.min.js"></script>
        
    






    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-37701128-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
